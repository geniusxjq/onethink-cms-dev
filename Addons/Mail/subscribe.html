<link type="text/css" rel="stylesheet" href="__ADDONROOT__/Public/subscribe.css?T=8">
<div id="subscribe_btn_box" class="subscribe_btn_box">
<a id="subscribe_btn" class="subscribe_btn"> 订阅 </a>
</div>
<script type="text/javascript">

$(function () {
			
	$('#subscribe_btn').popover({
		html:true,
		container:'#subscribe_btn_box',
		placement:'left',
		content:'<div class="row subscribe_box"><div class="row col-md-9 col-xs-9"><input id="email_address" name="email_address" type="text" class="form-control"></div><div class="row col-md-3 col-xs-3"><button id="subscribe_submit_btn" type="button" class="btn btn-info col-md-10 pull-right">提交</button></div></div>',
		
		template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'
		
	
	});
		
	$(document).on("click","#subscribe_submit_btn",function(){
		var patterns = /^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;
		var email_address = $('#email_address').val();
		if (email_address == '' || !patterns.test(email_address)) {
			$.zui.messager.warning('请输入正确的邮箱格式',{placement:'bottom-right'});
			return false;
		}
		
		$.post("{:addons_url('Mail://MailRss/subScribe','',C('DEFAULT_MODULE'))}",{email_address:email_address}, success, "json");
		
		return false;

		function success(data){
			if(data.status){
				$.zui.messager.success(data.info,{placement:'bottom-right'});
				$('#email_address').val('');
				$('#subscribe_btn').popover('hide');
			} else {
				$.zui.messager.info(data.info,{placement:'bottom-right'});
			}
		}
		
	});

})

</script>
